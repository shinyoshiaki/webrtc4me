{"version":3,"file":"index.js","sourceRoot":"","sources":["../../../src/extensions/wait/index.ts"],"names":[],"mappings":";;;AAAA,qDAA2B;AAE3B;IAGE;QAFQ,eAAU,GAA+B,EAAE,CAAC;IAErC,CAAC;IAER,oBAAK,GAAb,UAAc,EAAU;QACtB,OAAO,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;IACnD,CAAC;IAED,qBAAM,GAAN,UAAO,GAAW;QAChB,OAAO,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;IAC9B,CAAC;IAEK,qBAAM,GAAZ,UAAa,EAAU,EAAE,GAAqB;;;;;;6BACxC,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,EAAd,wBAAc;wBAChB,sBAAO,EAAE,KAAK,EAAE,IAAI,CAAC,UAAU,CAAC,EAAE,CAAC,EAAE,EAAC;;wBAEhC,UAAQ,IAAI,WAAK,EAAK,CAAC;wBAC7B,IAAI,CAAC,UAAU,CAAC,EAAE,CAAC,GAAG,OAAK,CAAC;wBAEb,qBAAM,GAAG,EAAE,EAAA;;wBAApB,MAAM,GAAG,SAAW;wBAC1B,OAAK,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;wBACtB,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;wBAEhB,sBAAO,EAAE,MAAM,QAAA,EAAE,EAAC;;;;KAErB;IACH,WAAC;AAAD,CAAC,AA3BD,IA2BC","sourcesContent":["import Event from \"../../\";\n\nexport default class Wait<T> {\n  private candidates: { [id: string]: Event<T> } = {};\n\n  constructor() {}\n\n  private exist(id: string) {\n    return Object.keys(this.candidates).includes(id);\n  }\n\n  delete(kid: string) {\n    delete this.candidates[kid];\n  }\n\n  async create(id: string, job: () => Promise<T>) {\n    if (this.exist(id)) {\n      return { exist: this.candidates[id] };\n    } else {\n      const event = new Event<T>();\n      this.candidates[id] = event;\n\n      const result = await job();\n      event.execute(result);\n      this.delete(id);\n\n      return { result };\n    }\n  }\n}\n"]}